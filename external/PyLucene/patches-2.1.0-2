--- PyLucene-src-2.0rc1-1/test/test_DbDirectory.py	2005-01-31 15:34:23.000000000 -0800
+++ PyLucene-src-2.0rc1-1-patched/test/test_DbDirectory.py	2006-03-29 13:16:51.000000000 -0800
@@ -96,8 +96,11 @@
 if __name__ == "__main__":
     try:
         DbDirectory
+        from bsddb import db
     except NameError:
         pass
+    except ImportError:
+        pass
     else:
         import sys
         if '-loop' in sys.argv:
--- PyLucene-src-2.0rc1-10/_PyLucene.cpp	2006-04-27 20:53:05.000000000 -0400
+++ PyLucene-src-2.0rc1-10-patched/_PyLucene.cpp	2006-05-24 20:28:26.000000000 -0400
@@ -32,6 +32,16 @@
 #include "java.h"
 #include "lucene.h"
 
+#ifdef EPRINTF
+#include <assert.h>
+void __eprintf(const char *format, const char *file, unsigned line,
+               const char *e)
+{
+    printf(format, file, line, e);
+    abort();
+}
+#endif
+
 
 /* const variable descriptor */
 
--- PyLucene-src-2.0rc1-10/Makefile	2006-05-24 01:57:54.000000000 -0400
+++ PyLucene-src-2.0rc1-10-patched/Makefile	2006-05-24 20:38:54.000000000 -0400
@@ -220,6 +220,7 @@
 ifeq ($(DEBUG),1)
 CCFLAGS=-O0 -g
 LDFLAGS=
+DEFINES:=$(DEFINES) -DEPRINTF
 else
 CCFLAGS=-O2
 LDFLAGS=
@@ -855,7 +856,8 @@
 install::
 	install $(GCJ_HOME)/bin/libiconv-2.dll $(PYTHON_SITE)
 ifdef DB
-	install $(LIBDB_JAVA_LIB) $(PREFIX_DB)/$(BUILD_DB)/$(BINDIR)
+	mkdir -p $(PREFIX)/bin
+	install $(LIBDB_JAVA_LIB) $(PREFIX)/bin
 endif
 endif
 endif
